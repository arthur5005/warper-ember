{"version":3,"file":"index.js","sources":["../src/core/wasm.ts","../src/components/virtualizer.gts","../src/components/warper-component.gts"],"sourcesContent":["/**\n * Warper WASM Integration for Ember\n *\n * Adapted from the warper library's core/wasm.ts\n * Framework-agnostic WASM wrapper for virtualization\n */\n\n// WASM module interface (runtime types)\ninterface WasmModule {\n  default: () => Promise<void>;\n  get_version: () => string;\n  bench_uniform: (count: number, iterations: number) => number;\n  QuantumVariable: new (sizes: Float64Array) => QuantumVariable;\n  QuantumUniform: new (count: number, size: number) => QuantumUniform;\n}\n\nexport interface QuantumVariable {\n  free(): void;\n  calc_range(\n    scrollOffset: number,\n    viewportSize: number,\n    overscan: number,\n  ): Float64Array;\n  get_offset(index: number): number;\n  get_size(index: number): number;\n  getRangeAndTotalHeight(\n    scrollOffset: number,\n    viewportSize: number,\n    overscan: number,\n  ): unknown;\n}\n\nexport interface QuantumUniform {\n  free(): void;\n  calc_range(\n    scrollOffset: number,\n    viewportSize: number,\n    overscan: number,\n  ): Float64Array;\n  set_count(count: number): void;\n  get_indices(start: number, end: number): Uint32Array;\n  get_offsets(start: number, end: number): Float64Array;\n}\n\nlet wasmModule: WasmModule | null = null;\n\nexport type WasmStatus = 'idle' | 'initializing' | 'ready' | 'error';\n\nexport interface WasmPerformanceStats {\n  initTime: number;\n  memoryUsage: number;\n  isOptimized: boolean;\n  version: string;\n  opsPerSecond: number;\n}\n\nexport interface WasmStatusInfo {\n  status: WasmStatus;\n  error: Error | null;\n  initTime: number;\n  memoryUsage: number;\n  isOptimized: boolean;\n  version: string;\n  opsPerSecond: number;\n}\n\nlet wasmStatus: WasmStatus = 'idle';\nlet wasmError: Error | null = null;\nlet initializationPromise: Promise<void> | null = null;\nconst performanceStats: WasmPerformanceStats = {\n  initTime: 0,\n  memoryUsage: 0,\n  isOptimized: false,\n  version: '0.0.0',\n  opsPerSecond: 0,\n};\n\nconst setStatus = (status: WasmStatus, error: Error | null = null) => {\n  wasmStatus = status;\n  wasmError = error;\n};\n\n/**\n * Initialize the WASM module.\n * Safe to call multiple times - will only initialize once.\n */\nexport const initializeWasm = (): Promise<void> => {\n  if (initializationPromise) {\n    return initializationPromise;\n  }\n\n  if (wasmStatus === 'ready') {\n    return Promise.resolve();\n  }\n\n  setStatus('initializing');\n  const startTime = performance.now();\n\n  initializationPromise = (async () => {\n    try {\n      const wasmBindings =\n        (await import('../wasm/warper_wasm.js')) as WasmModule;\n\n      wasmModule = wasmBindings;\n      const wasmInit = wasmBindings.default;\n\n      await wasmInit();\n\n      const endTime = performance.now();\n      performanceStats.initTime = endTime - startTime;\n      performanceStats.isOptimized = true;\n      performanceStats.version = wasmModule.get_version();\n\n      try {\n        performanceStats.opsPerSecond = wasmModule.bench_uniform(10000, 1000);\n      } catch {\n        performanceStats.opsPerSecond = 0;\n      }\n\n      setStatus('ready');\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      console.error('[Warper] WASM initialization failed:', error);\n      setStatus('error', error);\n      throw error;\n    } finally {\n      initializationPromise = null;\n    }\n  })();\n\n  return initializationPromise;\n};\n\nconst getWasmModule = (): WasmModule => {\n  if (wasmStatus !== 'ready' || !wasmModule) {\n    throw new Error('WASM not initialized. Call initializeWasm() first.');\n  }\n  return wasmModule;\n};\n\nexport const createVirtualizer = (sizes: number[]): QuantumVariable => {\n  const wasm = getWasmModule();\n  const sizesArray = new Float64Array(sizes);\n  return new wasm.QuantumVariable(sizesArray);\n};\n\nexport const createUniformVirtualizer = (\n  count: number,\n  size: number,\n): QuantumUniform => {\n  const wasm = getWasmModule();\n  return new wasm.QuantumUniform(count, size);\n};\n\nexport const getWasmStatus = (): WasmStatusInfo => ({\n  status: wasmStatus,\n  error: wasmError,\n  ...performanceStats,\n});\n\nexport const get_version = (): string => {\n  const wasm = getWasmModule();\n  return wasm.get_version();\n};\n","import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { modifier } from 'ember-modifier';\nimport { effect } from 'reactiveweb/effect';\n\nimport {\n  initializeWasm,\n  createVirtualizer,\n  createUniformVirtualizer,\n} from '../core/wasm.ts';\n\nimport type Owner from '@ember/owner';\nimport type { QuantumVariable, QuantumUniform } from '../core/wasm.ts';\nimport type { ModifierLike } from '@glint/template';\n\nconst MAX_SAFE_SCROLL_HEIGHT = 15_000_000;\n\nexport interface VirtualRange {\n  startIndex: number;\n  endIndex: number;\n  items: readonly number[];\n  offsets: readonly number[];\n  sizes: readonly number[];\n  totalHeight: number;\n  paddingTop: number;\n}\n\nexport interface VirtualizerState {\n  scrollElementRef: ModifierLike<{ Element: HTMLElement }>;\n  range: VirtualRange;\n  scrollToIndex: (index: number, behavior?: ScrollBehavior) => void;\n  scrollToOffset: (offset: number, behavior?: ScrollBehavior) => void;\n  isLoading: boolean;\n  error: Error | null;\n}\n\nexport interface VirtualizerSignature {\n  Args: {\n    itemCount: number;\n    estimateSize: (index: number) => number;\n    height?: number | string;\n    overscan?: number;\n    horizontal?: boolean;\n  };\n  Blocks: {\n    default: [virtualizer: VirtualizerState];\n  };\n}\n\nexport default class Virtualizer extends Component<VirtualizerSignature> {\n  @tracked isLoading = true;\n  @tracked error: Error | null = null;\n  @tracked range: VirtualRange = {\n    startIndex: 0,\n    endIndex: 0,\n    items: [],\n    offsets: [],\n    sizes: [],\n    totalHeight: 0,\n    paddingTop: 0,\n  };\n\n  // Non-reactive state\n  private element: HTMLElement | null = null;\n  private virtualizer: QuantumVariable | null = null;\n  private uniformVirtualizer: QuantumUniform | null = null;\n  private isUniform = false;\n  private uniformSize = 0;\n  private scrollMultiplier = 1;\n  private lastStart = -1;\n  private lastEnd = -1;\n  private lastPaddingTop = 0;\n  private rafId = 0;\n  private rafPending = false;\n  private wasmReady = false;\n\n  constructor(owner: Owner, args: VirtualizerSignature['Args']) {\n    super(owner, args);\n    void this.initialize();\n  }\n\n  willDestroy(): void {\n    super.willDestroy();\n\n    if (this.rafId) {\n      cancelAnimationFrame(this.rafId);\n    }\n    this.virtualizer?.free();\n    this.uniformVirtualizer?.free();\n    this.virtualizer = null;\n    this.uniformVirtualizer = null;\n  }\n\n  private get count(): number {\n    return this.args.itemCount;\n  }\n\n  private async initialize(): Promise<void> {\n    try {\n      await initializeWasm();\n      this.wasmReady = true;\n      this.setupVirtualizer();\n    } catch (err) {\n      this.error = err instanceof Error ? err : new Error(String(err));\n      this.isLoading = false;\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  handleItemCountChange = (_itemCount: number): void => {\n    if (!this.wasmReady || this.isLoading) return;\n\n    const count = this.count;\n\n    let virtualTotalHeight: number;\n\n    if (this.isUniform && this.uniformVirtualizer) {\n      // Fast path: just update count on existing uniform virtualizer\n      this.uniformVirtualizer.set_count(count);\n      virtualTotalHeight = count * this.uniformSize;\n    } else if (this.virtualizer) {\n      // Variable sizes: need to recreate virtualizer\n      const sizes = new Array<number>(count);\n      for (let i = 0; i < count; i++) sizes[i] = this.args.estimateSize(i);\n      this.virtualizer.free();\n      this.virtualizer = createVirtualizer(sizes);\n      virtualTotalHeight = sizes.reduce((a, b) => a + b, 0);\n    } else {\n      return;\n    }\n\n    if (virtualTotalHeight > MAX_SAFE_SCROLL_HEIGHT) {\n      this.scrollMultiplier = virtualTotalHeight / MAX_SAFE_SCROLL_HEIGHT;\n    } else {\n      this.scrollMultiplier = 1;\n    }\n\n    // Reset range tracking and recalculate\n    this.lastStart = -1;\n    this.lastEnd = -1;\n    this.calculateRange();\n  };\n\n  /** Initial virtualizer setup after WASM is ready */\n  private setupVirtualizer(): void {\n    const count = this.count;\n    const firstSize = this.args.estimateSize(0);\n\n    // Check if all items are the same size\n    let isUniform = true;\n    const checkCount = Math.min(10, count);\n    for (let i = 1; i < checkCount; i++) {\n      if (this.args.estimateSize(i) !== firstSize) {\n        isUniform = false;\n        break;\n      }\n    }\n\n    this.isUniform = isUniform;\n    this.uniformSize = firstSize;\n\n    let virtualTotalHeight: number;\n\n    if (isUniform) {\n      this.uniformVirtualizer = createUniformVirtualizer(count, firstSize);\n      virtualTotalHeight = count * firstSize;\n    } else {\n      const sizes = new Array<number>(count);\n      for (let i = 0; i < count; i++) sizes[i] = this.args.estimateSize(i);\n      this.virtualizer = createVirtualizer(sizes);\n      virtualTotalHeight = sizes.reduce((a, b) => a + b, 0);\n    }\n\n    if (virtualTotalHeight > MAX_SAFE_SCROLL_HEIGHT) {\n      this.scrollMultiplier = virtualTotalHeight / MAX_SAFE_SCROLL_HEIGHT;\n    } else {\n      this.scrollMultiplier = 1;\n    }\n\n    this.isLoading = false;\n\n    requestAnimationFrame(() => {\n      if (this.element) {\n        this.calculateRange();\n      }\n    });\n  }\n\n  private calculateRange = (): void => {\n    const el = this.element;\n\n    if (!el) return;\n\n    const horizontal = this.args.horizontal ?? false;\n    const overscan = this.args.overscan ?? 3;\n    const scrollPos = horizontal ? el.scrollLeft : el.scrollTop;\n    const viewportSize = horizontal ? el.clientWidth : el.clientHeight;\n\n    if (viewportSize <= 0) {\n      requestAnimationFrame(() => this.calculateRange());\n      return;\n    }\n\n    const virtualScroll = scrollPos * this.scrollMultiplier;\n\n    let start = 0;\n    let end = 0;\n\n    if (this.isUniform && this.uniformVirtualizer) {\n      const info = this.uniformVirtualizer.calc_range(\n        virtualScroll,\n        viewportSize,\n        overscan,\n      );\n      start = (info[0] ?? 0) | 0;\n      end = (info[1] ?? 0) | 0;\n    } else if (this.virtualizer) {\n      const info = this.virtualizer.calc_range(\n        virtualScroll,\n        viewportSize,\n        overscan,\n      );\n      start = (info[0] ?? 0) | 0;\n      end = (info[1] ?? 0) | 0;\n    } else {\n      return;\n    }\n\n    const totalCount = this.count;\n    start = Math.max(0, start);\n    end = Math.min(totalCount, end);\n\n    let firstItemVirtualOffset = 0;\n    if (this.isUniform) {\n      firstItemVirtualOffset = start * this.uniformSize;\n    } else if (this.virtualizer) {\n      firstItemVirtualOffset = this.virtualizer.get_offset(start);\n    }\n\n    const newPaddingTop = firstItemVirtualOffset / this.scrollMultiplier;\n\n    // Skip if unchanged\n    if (\n      start === this.lastStart &&\n      end === this.lastEnd &&\n      Math.abs(newPaddingTop - this.lastPaddingTop) < 0.5\n    ) {\n      return;\n    }\n\n    this.lastStart = start;\n    this.lastEnd = end;\n    this.lastPaddingTop = newPaddingTop;\n\n    const visibleCount = end - start;\n    const items: number[] = new Array<number>(visibleCount);\n    const offsets: number[] = new Array<number>(visibleCount);\n    const sizes: number[] = new Array<number>(visibleCount);\n\n    if (this.isUniform) {\n      const size = this.uniformSize;\n      for (let i = 0; i < visibleCount; i++) {\n        items[i] = start + i;\n        offsets[i] = i * size;\n        sizes[i] = size;\n      }\n    } else if (this.virtualizer) {\n      for (let i = 0; i < visibleCount; i++) {\n        const idx = start + i;\n        items[i] = idx;\n        offsets[i] = this.virtualizer.get_offset(idx) - firstItemVirtualOffset;\n        sizes[i] = this.virtualizer.get_size(idx);\n      }\n    }\n\n    const totalHeight = this.isUniform\n      ? (totalCount * this.uniformSize) / this.scrollMultiplier\n      : this.virtualizer\n        ? this.virtualizer.get_offset(totalCount) / this.scrollMultiplier\n        : 0;\n\n    this.range = {\n      startIndex: start,\n      endIndex: end,\n      items,\n      offsets,\n      sizes,\n      totalHeight: Math.min(totalHeight, MAX_SAFE_SCROLL_HEIGHT),\n      paddingTop: newPaddingTop,\n    };\n  };\n\n  private handleScroll = (): void => {\n    if (this.rafPending) return;\n    this.rafPending = true;\n\n    // Double RAF: let browser paint current frame first, then do our work\n    requestAnimationFrame(() => {\n      this.rafId = requestAnimationFrame(() => {\n        this.rafPending = false;\n        this.calculateRange();\n      });\n    });\n  };\n\n  scrollElementRef = modifier((element: HTMLElement) => {\n    if (this.element !== element) {\n      this.element?.removeEventListener('scroll', this.handleScroll);\n      this.element = element;\n      element.addEventListener('scroll', this.handleScroll, {\n        passive: true,\n      });\n\n      if (!this.isLoading) {\n        requestAnimationFrame(() => this.calculateRange());\n      }\n    }\n\n    return () => {\n      this.element?.removeEventListener('scroll', this.handleScroll);\n      this.element = null;\n    };\n  });\n\n  scrollToIndex = (index: number, behavior: ScrollBehavior = 'auto'): void => {\n    const el = this.element;\n    if (!el) return;\n\n    let offset = 0;\n    if (this.isUniform) {\n      offset = index * this.uniformSize;\n    } else if (this.virtualizer) {\n      offset = this.virtualizer.get_offset(index);\n    }\n\n    const scrollOffset = offset / this.scrollMultiplier;\n    const horizontal = this.args.horizontal ?? false;\n\n    el.scrollTo({\n      [horizontal ? 'left' : 'top']: scrollOffset,\n      behavior,\n    });\n  };\n\n  scrollToOffset = (\n    offset: number,\n    behavior: ScrollBehavior = 'auto',\n  ): void => {\n    const el = this.element;\n    if (!el) return;\n\n    const horizontal = this.args.horizontal ?? false;\n    el.scrollTo({\n      [horizontal ? 'left' : 'top']: offset,\n      behavior,\n    });\n  };\n\n  get virtualizerState(): VirtualizerState {\n    // Capture \"this\" for getters\n    // This pattern scopes reactivity to only the needed properties\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    return {\n      scrollElementRef: this.scrollElementRef,\n      get range() {\n        return self.range;\n      },\n      get error() {\n        return self.error;\n      },\n      get isLoading() {\n        return self.isLoading;\n      },\n      scrollToIndex: this.scrollToIndex,\n      scrollToOffset: this.scrollToOffset,\n    };\n  }\n\n  <template>\n    {{effect this.handleItemCountChange @itemCount}}\n    {{yield this.virtualizerState}}\n  </template>\n}\n","import Component from '@glimmer/component';\nimport { cached } from '@glimmer/tracking';\nimport { htmlSafe } from '@ember/template';\n\nimport Virtualizer from './virtualizer.gts';\n\nimport type { VirtualRange } from './virtualizer.gts';\nimport type { SafeString } from '@ember/template';\n\ntype YieldedItem<T> = [T] extends [never] ? number : T;\n\ninterface WarperCoreSignature<T = never> {\n  Args: {\n    range: VirtualRange;\n    items?: T[];\n    height?: number | string;\n    horizontal?: boolean;\n  };\n  Blocks: {\n    default: [item: YieldedItem<T>, index: number];\n  };\n  Element: HTMLDivElement;\n}\n\nclass WarperCoreComponent<T = never> extends Component<WarperCoreSignature<T>> {\n  get innerStyle(): SafeString {\n    const totalHeight = this.args.range.totalHeight || 1;\n    return htmlSafe(\n      `width:100%;position:relative;height:${totalHeight}px;pointer-events:none;`,\n    );\n  }\n\n  get viewportStyle(): SafeString {\n    const paddingTop = this.args.range.paddingTop;\n    return htmlSafe(\n      `position:absolute;top:0;left:0;width:100%;transform:translateY(${paddingTop}px);will-change:transform;`,\n    );\n  }\n\n  rowStyleAt = (i: number): SafeString => {\n    const offset = this.args.range.offsets[i] ?? 0;\n    const size = this.args.range.sizes[i] ?? 0;\n    return htmlSafe(\n      `position:absolute;top:0;left:0;width:100%;contain:layout style paint;will-change:transform;transform:translateY(${offset}px);height:${size}px;pointer-events:auto;`,\n    );\n  };\n\n  get isItemsMode(): boolean {\n    return this.args.items !== undefined;\n  }\n\n  getItem = (index: number): YieldedItem<T> => {\n    if (this.isItemsMode) {\n      return this.args.items![index] as YieldedItem<T>;\n    }\n    return index as YieldedItem<T>;\n  };\n\n  <template>\n    <div style={{this.innerStyle}} data-warper-inner>\n      <div style={{this.viewportStyle}} data-warper-viewport>\n        {{#each @range.items key=\"@identity\" as |index i|}}\n          <div style={{this.rowStyleAt i}} data-index={{index}}>\n            {{yield (this.getItem index) index}}\n          </div>\n        {{/each}}\n      </div>\n    </div>\n  </template>\n}\n\nexport interface WarperComponentSignature<T = never> {\n  Args: {\n    items?: T[];\n    itemCount?: number;\n    estimateSize: (index: number) => number;\n    height?: number | string;\n    overscan?: number;\n    horizontal?: boolean;\n  };\n  Blocks: {\n    default: [item: YieldedItem<T>, index: number];\n    loading: [];\n    error: [error: Error];\n  };\n  Element: HTMLDivElement;\n}\n\nexport default class WarperComponent<T = never> extends Component<\n  WarperComponentSignature<T>\n> {\n  @cached\n  get containerStyle(): SafeString {\n    const height = this.args.height;\n    const h = typeof height === 'number' ? `${height}px` : (height ?? '100%');\n    return htmlSafe(\n      `width:100%;overflow:auto;position:relative;overscroll-behavior:contain;contain:strict;height:${h};`,\n    );\n  }\n\n  get itemCount(): number {\n    return this.args.itemCount ?? this.args.items?.length ?? 0;\n  }\n\n  <template>\n    <Virtualizer\n      @itemCount={{this.itemCount}}\n      @estimateSize={{@estimateSize}}\n      @height={{@height}}\n      @overscan={{@overscan}}\n      @horizontal={{@horizontal}}\n      as |v|\n    >\n      <div\n        {{v.scrollElementRef}}\n        style={{this.containerStyle}}\n        data-warper-container\n        ...attributes\n      >\n        {{#if v.error}}\n          {{#if (has-block \"error\")}}\n            {{yield v.error to=\"error\"}}\n          {{else}}\n            <div data-warper-error>\n              {{v.error.message}}\n            </div>\n          {{/if}}\n        {{else if v.isLoading}}\n          {{#if (has-block \"loading\")}}\n            {{yield to=\"loading\"}}\n          {{else}}\n            <div data-warper-loading>\n              Loading...\n            </div>\n          {{/if}}\n        {{else}}\n          <WarperCoreComponent\n            @items={{@items}}\n            @height={{@height}}\n            @horizontal={{@horizontal}}\n            @range={{v.range}}\n            as |item index|\n          >\n            {{yield item index}}\n          </WarperCoreComponent>\n        {{/if}}\n      </div>\n    </Virtualizer>\n  </template>\n}\n"],"names":["wasmModule","wasmStatus","initializationPromise","performanceStats","initTime","memoryUsage","isOptimized","version","opsPerSecond","setStatus","status","error","initializeWasm","Promise","resolve","startTime","performance","now","wasmBindings","wasmInit","default","endTime","get_version","bench_uniform","err","Error","String","console","getWasmModule","createVirtualizer","sizes","wasm","sizesArray","Float64Array","QuantumVariable","createUniformVirtualizer","count","size","QuantumUniform","MAX_SAFE_SCROLL_HEIGHT","Virtualizer","Component","g","prototype","tracked","i","startIndex","endIndex","items","offsets","totalHeight","paddingTop","element","virtualizer","uniformVirtualizer","isUniform","uniformSize","scrollMultiplier","lastStart","lastEnd","lastPaddingTop","rafId","rafPending","wasmReady","constructor","owner","args","initialize","willDestroy","cancelAnimationFrame","free","itemCount","setupVirtualizer","isLoading","handleItemCountChange","_itemCount","virtualTotalHeight","set_count","Array","estimateSize","reduce","a","b","calculateRange","firstSize","checkCount","Math","min","requestAnimationFrame","el","horizontal","overscan","scrollPos","scrollLeft","scrollTop","viewportSize","clientWidth","clientHeight","virtualScroll","start","end","info","calc_range","totalCount","max","firstItemVirtualOffset","get_offset","newPaddingTop","abs","visibleCount","idx","get_size","range","handleScroll","scrollElementRef","modifier","removeEventListener","addEventListener","passive","scrollToIndex","index","behavior","offset","scrollOffset","scrollTo","scrollToOffset","virtualizerState","self","setComponentTemplate","precompileTemplate","strictMode","scope","effect","WarperCoreComponent","innerStyle","htmlSafe","viewportStyle","rowStyleAt","isItemsMode","undefined","getItem","WarperComponent","containerStyle","height","h","n","cached","length"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAqCA,IAAIA,UAA6B,GAAG,IAAI;AAsBxC,IAAIC,UAAsB,GAAG,MAAM;AAEnC,IAAIC,qBAA2C,GAAG,IAAI;AACtD,MAAMC,gBAAsC,GAAG;AAC7CC,EAAAA,QAAQ,EAAE,CAAC;AACXC,EAAAA,WAAW,EAAE,CAAC;AACdC,EAAAA,WAAW,EAAE,KAAK;AAClBC,EAAAA,OAAO,EAAE,OAAO;AAChBC,EAAAA,YAAY,EAAE;AAChB,CAAC;AAED,MAAMC,SAAS,GAAGA,CAACC,MAAkB,EAAEC,KAAmB,GAAG,IAAI,KAAK;AACpEV,EAAAA,UAAU,GAAGS,MAAM;AAErB,CAAC;;AAED;AACA;AACA;AACA;AACO,MAAME,cAAc,GAAGA,MAAqB;AACjD,EAAA,IAAIV,qBAAqB,EAAE;AACzB,IAAA,OAAOA,qBAAqB;AAC9B,EAAA;EAEA,IAAID,UAAU,KAAK,OAAO,EAAE;AAC1B,IAAA,OAAOY,OAAO,CAACC,OAAO,EAAE;AAC1B,EAAA;EAEAL,SAAS,CAAC,cAAc,CAAC;AACzB,EAAA,MAAMM,SAAS,GAAGC,WAAW,CAACC,GAAG,EAAE;EAEnCf,qBAAqB,GAAG,CAAC,YAAY;IACnC,IAAI;AACF,MAAA,MAAMgB,YAAY,GACf,MAAM,OAAO,2BAAwB,CAAgB;AAExDlB,MAAAA,UAAU,GAAGkB,YAAY;AACzB,MAAA,MAAMC,QAAQ,GAAGD,YAAY,CAACE,OAAO;MAErC,MAAMD,QAAQ,EAAE;AAEhB,MAAA,MAAME,OAAO,GAAGL,WAAW,CAACC,GAAG,EAAE;AACjCd,MAAAA,gBAAgB,CAACC,QAAQ,GAAGiB,OAAO,GAAGN,SAAS;MAC/CZ,gBAAgB,CAACG,WAAW,GAAG,IAAI;AACnCH,MAAAA,gBAAgB,CAACI,OAAO,GAAGP,UAAU,CAACsB,WAAW,EAAE;MAEnD,IAAI;QACFnB,gBAAgB,CAACK,YAAY,GAAGR,UAAU,CAACuB,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC;AACvE,MAAA,CAAC,CAAC,MAAM;QACNpB,gBAAgB,CAACK,YAAY,GAAG,CAAC;AACnC,MAAA;MAEAC,SAAS,CAAC,OAAO,CAAC;IACpB,CAAC,CAAC,OAAOe,GAAG,EAAE;AACZ,MAAA,MAAMb,KAAK,GAAGa,GAAG,YAAYC,KAAK,GAAGD,GAAG,GAAG,IAAIC,KAAK,CAACC,MAAM,CAACF,GAAG,CAAC,CAAC;AACjEG,MAAAA,OAAO,CAAChB,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;AAC5DF,MAAAA,SAAS,CAAC,OAAO,EAAEE,KAAK,CAAC;AACzB,MAAA,MAAMA,KAAK;AACb,IAAA,CAAC,SAAS;AACRT,MAAAA,qBAAqB,GAAG,IAAI;AAC9B,IAAA;AACF,EAAA,CAAC,GAAG;AAEJ,EAAA,OAAOA,qBAAqB;AAC9B,CAAC;AAED,MAAM0B,aAAa,GAAGA,MAAkB;AACtC,EAAA,IAAI3B,UAAU,KAAK,OAAO,IAAI,CAACD,UAAU,EAAE;AACzC,IAAA,MAAM,IAAIyB,KAAK,CAAC,oDAAoD,CAAC;AACvE,EAAA;AACA,EAAA,OAAOzB,UAAU;AACnB,CAAC;AAEM,MAAM6B,iBAAiB,GAAIC,KAAe,IAAsB;AACrE,EAAA,MAAMC,IAAI,GAAGH,aAAa,EAAE;AAC5B,EAAA,MAAMI,UAAU,GAAG,IAAIC,YAAY,CAACH,KAAK,CAAC;AAC1C,EAAA,OAAO,IAAIC,IAAI,CAACG,eAAe,CAACF,UAAU,CAAC;AAC7C,CAAC;AAEM,MAAMG,wBAAwB,GAAGA,CACtCC,KAAa,EACbC,IAAY,KACO;AACnB,EAAA,MAAMN,IAAI,GAAGH,aAAa,EAAE;EAC5B,OAAO,IAAIG,IAAI,CAACO,cAAc,CAACF,KAAK,EAAEC,IAAI,CAAC;AAC7C,CAAC;;ACzID,MAAME,sBAAA,GAAyB,UAAA;AAkChB,MAAMC,oBAAoBC,SAAA,CAAU;AAAA,EAAA;IAAAC,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,WAAA,EAAA,CAChDC,OAAA,CAAA,EAAA,YAAA;AAAA,MAAA,OAAoB,IAAA;AAAA,IAAA,CAAA,CAAA;AAAA;EAAA,UAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,WAAA,CAAA,EAAA,MAAA;AAAA,EAAA;IAAAH,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,OAAA,EAAA,CACpBC,OAAA,CAAA,EAAA,YAAA;AAAA,MAAA,OAA8B,IAAA;AAAA,IAAA,CAAA,CAAA;AAAA;EAAA,MAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,OAAA,CAAA,EAAA,MAAA;AAAA,EAAA;IAAAH,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,OAAA,EAAA,CAC9BC,OAAA,CAAA,EAAA,YAAA;MAAA,OAA8B;AAC7BE,QAAAA,UAAA,EAAY,CAAA;AACZC,QAAAA,QAAA,EAAU,CAAA;AACVC,QAAAA,KAAA,EAAO,EAAE;AACTC,QAAAA,OAAA,EAAS,EAAE;AACXnB,QAAAA,KAAA,EAAO,EAAE;AACToB,QAAAA,WAAA,EAAa,CAAA;AACbC,QAAAA,UAAA,EAAY;OACd;AAAA,IAAA,CAAA,CAAA;AAAA;EAAA,MAAA,IAAAN,CAAA,CAAA,IAAA,EAAA,OAAA,CAAA,EAAA,MAAA;AAEA;AACQO,EAAAA,OAAA,GAA8B,IAAA;AAC9BC,EAAAA,WAAA,GAAsC,IAAA;AACtCC,EAAAA,kBAAA,GAA4C,IAAA;AAC5CC,EAAAA,YAAY,KAAA;AACZC,EAAAA,cAAc,CAAA;AACdC,EAAAA,mBAAmB,CAAA;EACnBC,SAAA,GAAY,EAAC;EACbC,OAAA,GAAU,EAAC;AACXC,EAAAA,iBAAiB,CAAA;AACjBC,EAAAA,QAAQ,CAAA;AACRC,EAAAA,aAAa,KAAA;AACbC,EAAAA,YAAY,KAAA;AAEpBC,EAAAA,WAAAA,CAAYC,KAAY,EAAEC,IAAkC,EAAE;AAC5D,IAAA,KAAK,CAACD,KAAA,EAAOC,IAAA,CAAA;AACb,IAAA,KAAK,IAAI,CAACC,UAAU,EAAA;AACtB,EAAA;AAEAC,EAAAA,WAAAA,GAAoB;IAClB,KAAK,CAACA,WAAA,EAAA;IAEN,IAAI,IAAI,CAACP,KAAK,EAAE;AACdQ,MAAAA,oBAAA,CAAqB,IAAI,CAACR,KAAK,CAAA;AACjC,IAAA;AACA,IAAA,IAAI,CAACR,WAAW,EAAEiB,IAAA,EAAA;AAClB,IAAA,IAAI,CAAChB,kBAAkB,EAAEgB,IAAA,EAAA;IACzB,IAAI,CAACjB,WAAW,GAAG,IAAA;IACnB,IAAI,CAACC,kBAAkB,GAAG,IAAA;AAC5B,EAAA;EAEA,IAAYlB,KAAAA,GAAgB;AAC1B,IAAA,OAAO,IAAI,CAAC8B,IAAI,CAACK,SAAS;AAC5B,EAAA;EAEA,MAAcJ,UAAAA,GAA4B;IACxC,IAAI;MACF,MAAMvD,cAAA,EAAA;MACN,IAAI,CAACmD,SAAS,GAAG,IAAA;MACjB,IAAI,CAACS,gBAAgB,EAAA;IACvB,CAAA,CAAE,OAAOhD,GAAA,EAAK;AACZ,MAAA,IAAI,CAACb,KAAK,GAAGa,GAAA,YAAeC,QAAQD,GAAA,GAAM,IAAIC,MAAMC,MAAA,CAAOF,GAAA,CAAA,CAAA;MAC3D,IAAI,CAACiD,SAAS,GAAG,KAAA;AACnB,IAAA;AACF,EAAA;AAEA;EACAC,qBAAA,GAAyBC,UAAkB,IAAO;IAChD,IAAI,CAAC,IAAI,CAACZ,SAAS,IAAI,IAAI,CAACU,SAAS,EAAE;AAEvC,IAAA,MAAMrC,KAAA,GAAQ,IAAI,CAACA,KAAK;AAExB,IAAA,IAAIwC,kBAA0B;AAE9B,IAAA,IAAI,IAAI,CAACrB,SAAS,IAAI,IAAI,CAACD,kBAAkB,EAAE;AAC7C;AACA,MAAA,IAAI,CAACA,kBAAkB,CAACuB,SAAS,CAACzC,KAAA,CAAA;AAClCwC,MAAAA,kBAAA,GAAqBxC,KAAA,GAAQ,IAAI,CAACoB,WAAW;AAC/C,IAAA,CAAA,MAAO,IAAI,IAAI,CAACH,WAAW,EAAE;AAC3B;AACA,MAAA,MAAMvB,KAAA,GAAQ,IAAIgD,KAAA,CAAc1C,KAAA,CAAA;MAChC,KAAK,IAAIS,CAAA,GAAI,CAAA,EAAGA,CAAA,GAAIT,OAAOS,CAAA,EAAA,EAAKf,KAAK,CAACe,CAAA,CAAE,GAAG,IAAI,CAACqB,IAAI,CAACa,YAAY,CAAClC,CAAA,CAAA;AAClE,MAAA,IAAI,CAACQ,WAAW,CAACiB,IAAI,EAAA;AACrB,MAAA,IAAI,CAACjB,WAAW,GAAGxB,iBAAA,CAAkBC,KAAA,CAAA;AACrC8C,MAAAA,kBAAA,GAAqB9C,MAAMkD,MAAM,CAAC,CAACC,CAAA,EAAGC,CAAA,KAAMD,IAAIC,CAAA,EAAG,CAAA,CAAA;AACrD,IAAA,CAAA,MAAO;AACL,MAAA;AACF,IAAA;IAEA,IAAIN,qBAAqBrC,sBAAA,EAAwB;AAC/C,MAAA,IAAI,CAACkB,gBAAgB,GAAGmB,kBAAA,GAAqBrC,sBAAA;AAC/C,IAAA,CAAA,MAAO;MACL,IAAI,CAACkB,gBAAgB,GAAG,CAAA;AAC1B,IAAA;AAEA;AACA,IAAA,IAAI,CAACC,SAAS,GAAG,EAAC;AAClB,IAAA,IAAI,CAACC,OAAO,GAAG,EAAC;IAChB,IAAI,CAACwB,cAAc,EAAA;EACrB,CAAA;AAEA;AACQX,EAAAA,gBAAAA,GAAyB;AAC/B,IAAA,MAAMpC,KAAA,GAAQ,IAAI,CAACA,KAAK;IACxB,MAAMgD,YAAY,IAAI,CAAClB,IAAI,CAACa,YAAY,CAAC,CAAA,CAAA;AAEzC;IACA,IAAIxB,SAAA,GAAY,IAAA;IAChB,MAAM8B,UAAA,GAAaC,IAAA,CAAKC,GAAG,CAAC,EAAA,EAAInD,KAAA,CAAA;IAChC,KAAK,IAAIS,CAAA,GAAI,CAAA,EAAGA,CAAA,GAAIwC,YAAYxC,CAAA,EAAA,EAAK;MACnC,IAAI,IAAI,CAACqB,IAAI,CAACa,YAAY,CAAClC,OAAOuC,SAAA,EAAW;AAC3C7B,QAAAA,SAAA,GAAY,KAAA;AACZ,QAAA;AACF,MAAA;AACF,IAAA;IAEA,IAAI,CAACA,SAAS,GAAGA,SAAA;IACjB,IAAI,CAACC,WAAW,GAAG4B,SAAA;AAEnB,IAAA,IAAIR,kBAA0B;AAE9B,IAAA,IAAIrB,SAAA,EAAW;MACb,IAAI,CAACD,kBAAkB,GAAGnB,wBAAA,CAAyBC,KAAA,EAAOgD,SAAA,CAAA;MAC1DR,kBAAA,GAAqBxC,KAAA,GAAQgD,SAAA;AAC/B,IAAA,CAAA,MAAO;AACL,MAAA,MAAMtD,KAAA,GAAQ,IAAIgD,KAAA,CAAc1C,KAAA,CAAA;MAChC,KAAK,IAAIS,CAAA,GAAI,CAAA,EAAGA,CAAA,GAAIT,OAAOS,CAAA,EAAA,EAAKf,KAAK,CAACe,CAAA,CAAE,GAAG,IAAI,CAACqB,IAAI,CAACa,YAAY,CAAClC,CAAA,CAAA;AAClE,MAAA,IAAI,CAACQ,WAAW,GAAGxB,iBAAA,CAAkBC,KAAA,CAAA;AACrC8C,MAAAA,kBAAA,GAAqB9C,MAAMkD,MAAM,CAAC,CAACC,CAAA,EAAGC,CAAA,KAAMD,IAAIC,CAAA,EAAG,CAAA,CAAA;AACrD,IAAA;IAEA,IAAIN,qBAAqBrC,sBAAA,EAAwB;AAC/C,MAAA,IAAI,CAACkB,gBAAgB,GAAGmB,kBAAA,GAAqBrC,sBAAA;AAC/C,IAAA,CAAA,MAAO;MACL,IAAI,CAACkB,gBAAgB,GAAG,CAAA;AAC1B,IAAA;IAEA,IAAI,CAACgB,SAAS,GAAG,KAAA;AAEjBe,IAAAA,qBAAA,CAAsB,MAAA;MACpB,IAAI,IAAI,CAACpC,OAAO,EAAE;QAChB,IAAI,CAAC+B,cAAc,EAAA;AACrB,MAAA;AACF,IAAA,CAAA,CAAA;AACF,EAAA;EAEQA,cAAA,GAAiBA,MAAQ;AAC/B,IAAA,MAAMM,EAAA,GAAK,IAAI,CAACrC,OAAO;IAEvB,IAAI,CAACqC,EAAA,EAAI;IAET,MAAMC,aAAa,IAAI,CAACxB,IAAI,CAACwB,UAAU,IAAI,KAAA;IAC3C,MAAMC,WAAW,IAAI,CAACzB,IAAI,CAACyB,QAAQ,IAAI,CAAA;IACvC,MAAMC,YAAYF,UAAA,GAAaD,EAAA,CAAGI,UAAU,GAAGJ,GAAGK,SAAS;IAC3D,MAAMC,eAAeL,UAAA,GAAaD,EAAA,CAAGO,WAAW,GAAGP,GAAGQ,YAAY;IAElE,IAAIF,gBAAgB,CAAA,EAAG;AACrBP,MAAAA,qBAAA,CAAsB,MAAM,IAAI,CAACL,cAAc,EAAA,CAAA;AAC/C,MAAA;AACF,IAAA;AAEA,IAAA,MAAMe,aAAA,GAAgBN,SAAA,GAAY,IAAI,CAACnC,gBAAgB;IAEvD,IAAI0C,KAAA,GAAQ,CAAA;IACZ,IAAIC,GAAA,GAAM,CAAA;AAEV,IAAA,IAAI,IAAI,CAAC7C,SAAS,IAAI,IAAI,CAACD,kBAAkB,EAAE;AAC7C,MAAA,MAAM+C,IAAA,GAAO,IAAI,CAAC/C,kBAAkB,CAACgD,UAAU,CAC7CJ,eACAH,YAAA,EACAJ,QAAA,CAAA;MAEFQ,KAAA,GAAQ,CAACE,IAAI,CAAC,CAAA,CAAE,IAAI,CAAC,IAAI,CAAA;MACzBD,GAAA,GAAM,CAACC,IAAI,CAAC,CAAA,CAAE,IAAI,CAAC,IAAI,CAAA;AACzB,IAAA,CAAA,MAAO,IAAI,IAAI,CAAChD,WAAW,EAAE;AAC3B,MAAA,MAAMgD,IAAA,GAAO,IAAI,CAAChD,WAAW,CAACiD,UAAU,CACtCJ,eACAH,YAAA,EACAJ,QAAA,CAAA;MAEFQ,KAAA,GAAQ,CAACE,IAAI,CAAC,CAAA,CAAE,IAAI,CAAC,IAAI,CAAA;MACzBD,GAAA,GAAM,CAACC,IAAI,CAAC,CAAA,CAAE,IAAI,CAAC,IAAI,CAAA;AACzB,IAAA,CAAA,MAAO;AACL,MAAA;AACF,IAAA;AAEA,IAAA,MAAME,UAAA,GAAa,IAAI,CAACnE,KAAK;IAC7B+D,KAAA,GAAQb,IAAA,CAAKkB,GAAG,CAAC,CAAA,EAAGL,KAAA,CAAA;IACpBC,GAAA,GAAMd,IAAA,CAAKC,GAAG,CAACgB,UAAA,EAAYH,GAAA,CAAA;IAE3B,IAAIK,sBAAA,GAAyB,CAAA;IAC7B,IAAI,IAAI,CAAClD,SAAS,EAAE;AAClBkD,MAAAA,sBAAA,GAAyBN,KAAA,GAAQ,IAAI,CAAC3C,WAAW;AACnD,IAAA,CAAA,MAAO,IAAI,IAAI,CAACH,WAAW,EAAE;MAC3BoD,sBAAA,GAAyB,IAAI,CAACpD,WAAW,CAACqD,UAAU,CAACP,KAAA,CAAA;AACvD,IAAA;AAEA,IAAA,MAAMQ,aAAA,GAAgBF,sBAAA,GAAyB,IAAI,CAAChD,gBAAgB;AAEpE;IACA,IACE0C,UAAU,IAAI,CAACzC,SAAS,IACxB0C,GAAA,KAAQ,IAAI,CAACzC,OAAO,IACpB2B,IAAA,CAAKsB,GAAG,CAACD,aAAA,GAAgB,IAAI,CAAC/C,cAAc,IAAI,GAAA,EAChD;AACA,MAAA;AACF,IAAA;IAEA,IAAI,CAACF,SAAS,GAAGyC,KAAA;IACjB,IAAI,CAACxC,OAAO,GAAGyC,GAAA;IACf,IAAI,CAACxC,cAAc,GAAG+C,aAAA;AAEtB,IAAA,MAAME,eAAeT,GAAA,GAAMD,KAAA;AAC3B,IAAA,MAAMnD,KAAa,GAAK,IAAI8B,KAAA,CAAc+B,YAAA,CAAA;AAC1C,IAAA,MAAM5D,OAAe,GAAK,IAAI6B,KAAA,CAAc+B,YAAA,CAAA;AAC5C,IAAA,MAAM/E,KAAa,GAAK,IAAIgD,KAAA,CAAc+B,YAAA,CAAA;IAE1C,IAAI,IAAI,CAACtD,SAAS,EAAE;AAClB,MAAA,MAAMlB,IAAA,GAAO,IAAI,CAACmB,WAAW;MAC7B,KAAK,IAAIX,CAAA,GAAI,CAAA,EAAGA,CAAA,GAAIgE,cAAchE,CAAA,EAAA,EAAK;AACrCG,QAAAA,KAAK,CAACH,CAAA,CAAE,GAAGsD,KAAA,GAAQtD,CAAA;AACnBI,QAAAA,OAAO,CAACJ,CAAA,CAAE,GAAGA,CAAA,GAAIR,IAAA;AACjBP,QAAAA,KAAK,CAACe,EAAE,GAAGR,IAAA;AACb,MAAA;AACF,IAAA,CAAA,MAAO,IAAI,IAAI,CAACgB,WAAW,EAAE;MAC3B,KAAK,IAAIR,CAAA,GAAI,CAAA,EAAGA,CAAA,GAAIgE,cAAchE,CAAA,EAAA,EAAK;AACrC,QAAA,MAAMiE,MAAMX,KAAA,GAAQtD,CAAA;AACpBG,QAAAA,KAAK,CAACH,EAAE,GAAGiE,GAAA;AACX7D,QAAAA,OAAO,CAACJ,EAAE,GAAG,IAAI,CAACQ,WAAW,CAACqD,UAAU,CAACI,GAAA,CAAA,GAAOL,sBAAA;QAChD3E,KAAK,CAACe,EAAE,GAAG,IAAI,CAACQ,WAAW,CAAC0D,QAAQ,CAACD,GAAA,CAAA;AACvC,MAAA;AACF,IAAA;AAEA,IAAA,MAAM5D,WAAA,GAAc,IAAI,CAACK,SAAS,GAC7BgD,UAAA,GAAa,IAAI,CAAC/C,WAAW,GAAI,IAAI,CAACC,gBAAgB,GACvD,IAAI,CAACJ,WAAW,GACd,IAAI,CAACA,WAAW,CAACqD,UAAU,CAACH,UAAA,CAAA,GAAc,IAAI,CAAC9C,gBAAgB,GAC/D,CAAA;IAEN,IAAI,CAACuD,KAAK,GAAG;AACXlE,MAAAA,UAAA,EAAYqD,KAAA;AACZpD,MAAAA,QAAA,EAAUqD,GAAA;MACVpD,KAAA;MACAC,OAAA;MACAnB,KAAA;MACAoB,WAAA,EAAaoC,IAAA,CAAKC,GAAG,CAACrC,WAAA,EAAaX,sBAAA,CAAA;AACnCY,MAAAA,UAAA,EAAYwD;KACd;EACF,CAAA;EAEQM,YAAA,GAAeA,MAAQ;IAC7B,IAAI,IAAI,CAACnD,UAAU,EAAE;IACrB,IAAI,CAACA,UAAU,GAAG,IAAA;AAElB;AACA0B,IAAAA,qBAAA,CAAsB,MAAA;AACpB,MAAA,IAAI,CAAC3B,KAAK,GAAG2B,qBAAA,CAAsB,MAAA;QACjC,IAAI,CAAC1B,UAAU,GAAG,KAAA;QAClB,IAAI,CAACqB,cAAc,EAAA;AACrB,MAAA,CAAA,CAAA;AACF,IAAA,CAAA,CAAA;EACF,CAAA;AAEA+B,EAAAA,gBAAA,GAAmBC,QAAA,CAAU/D,OAAS,IAAA;AACpC,IAAA,IAAI,IAAI,CAACA,OAAO,KAAKA,OAAA,EAAS;MAC5B,IAAI,CAACA,OAAO,EAAEgE,oBAAoB,QAAA,EAAU,IAAI,CAACH,YAAY,CAAA;MAC7D,IAAI,CAAC7D,OAAO,GAAGA,OAAA;MACfA,OAAA,CAAQiE,gBAAgB,CAAC,QAAA,EAAU,IAAI,CAACJ,YAAY,EAAE;AACpDK,QAAAA,OAAA,EAAS;AACX,OAAA,CAAA;AAEA,MAAA,IAAI,CAAC,IAAI,CAAC7C,SAAS,EAAE;AACnBe,QAAAA,qBAAA,CAAsB,MAAM,IAAI,CAACL,cAAc,EAAA,CAAA;AACjD,MAAA;AACF,IAAA;AAEA,IAAA,OAAO,MAAA;MACL,IAAI,CAAC/B,OAAO,EAAEgE,oBAAoB,QAAA,EAAU,IAAI,CAACH,YAAY,CAAA;MAC7D,IAAI,CAAC7D,OAAO,GAAG,IAAA;IACjB,CAAA;AACF,EAAA,CAAA,CAAA;AAEAmE,EAAAA,aAAA,GAAgBA,CAACC,KAAa,EAAEC,QAAU,GAAiB,MAAM,KAAO;AACtE,IAAA,MAAMhC,EAAA,GAAK,IAAI,CAACrC,OAAO;IACvB,IAAI,CAACqC,EAAA,EAAI;IAET,IAAIiC,MAAA,GAAS,CAAA;IACb,IAAI,IAAI,CAACnE,SAAS,EAAE;AAClBmE,MAAAA,MAAA,GAASF,KAAA,GAAQ,IAAI,CAAChE,WAAW;AACnC,IAAA,CAAA,MAAO,IAAI,IAAI,CAACH,WAAW,EAAE;MAC3BqE,MAAA,GAAS,IAAI,CAACrE,WAAW,CAACqD,UAAU,CAACc,KAAA,CAAA;AACvC,IAAA;AAEA,IAAA,MAAMG,YAAA,GAAeD,MAAA,GAAS,IAAI,CAACjE,gBAAgB;IACnD,MAAMiC,aAAa,IAAI,CAACxB,IAAI,CAACwB,UAAU,IAAI,KAAA;IAE3CD,EAAA,CAAGmC,QAAQ,CAAC;AACV,MAAA,CAAClC,UAAA,GAAa,MAAA,GAAS,KAAA,GAAQiC,YAAA;AAC/BF,MAAAA;AACF,KAAA,CAAA;EACF,CAAA;AAEAI,EAAAA,cAAA,GAAiBA,CACfH,MAAc,EACdD,QAAU,GAAiB,MAAM,KAC5B;AACL,IAAA,MAAMhC,EAAA,GAAK,IAAI,CAACrC,OAAO;IACvB,IAAI,CAACqC,EAAA,EAAI;IAET,MAAMC,aAAa,IAAI,CAACxB,IAAI,CAACwB,UAAU,IAAI,KAAA;IAC3CD,EAAA,CAAGmC,QAAQ,CAAC;AACV,MAAA,CAAClC,UAAA,GAAa,MAAA,GAAS,KAAA,GAAQgC,MAAA;AAC/BD,MAAAA;AACF,KAAA,CAAA;EACF,CAAA;EAEA,IAAIK,mBAAqC;AACvC;AACA;AACA;IACA,MAAMC,OAAO,IAAI;IACjB,OAAO;MACLb,gBAAA,EAAkB,IAAI,CAACA,gBAAgB;MACvC,IAAIF,KAAAA,GAAQ;QACV,OAAOe,KAAKf,KAAK;MACnB,CAAA;MACA,IAAIrG,KAAAA,GAAQ;QACV,OAAOoH,KAAKpH,KAAK;MACnB,CAAA;MACA,IAAI8D,SAAAA,GAAY;QACd,OAAOsD,KAAKtD,SAAS;MACvB,CAAA;MACA8C,aAAA,EAAe,IAAI,CAACA,aAAa;MACjCM,cAAA,EAAgB,IAAI,CAACA;KACvB;AACF,EAAA;AAEA,EAAA;IAAAG,oBAAA,CAAAC,kBAAA,CAAA,mFAAA,EAGA;MAAAC,UAAA,EAAA,IAAA;AAAAC,MAAAA,KAAA,EAAAA,OAAA;AAAAC,QAAAA;AAAA,OAAA;KAAU,CAAA,EAAV,IAAW,CAAA;AAAD;AACZ;;ACvWA,MAAMC,mBAAA,SAAuC5F,UAA8B;EACzE,IAAI6F,aAAyB;IAC3B,MAAMpF,WAAA,GAAc,IAAI,CAACgB,IAAI,CAAC8C,KAAK,CAAC9D,WAAW,IAAI,CAAA;AACnD,IAAA,OAAOqF,SACL,CAAA,oCAAA,EAAuCrF,WAAA,yBAAoC,CAAA;AAE/E,EAAA;EAEA,IAAIsF,gBAA4B;IAC9B,MAAMrF,aAAa,IAAI,CAACe,IAAI,CAAC8C,KAAK,CAAC7D,UAAU;AAC7C,IAAA,OAAOoF,SACL,CAAA,+DAAA,EAAkEpF,UAAA,4BAAsC,CAAA;AAE5G,EAAA;EAEAsF,UAAA,GAAc5F,CAAS,IAAG;AACxB,IAAA,MAAM6E,MAAA,GAAS,IAAI,CAACxD,IAAI,CAAC8C,KAAK,CAAC/D,OAAO,CAACJ,CAAA,CAAE,IAAI,CAAA;AAC7C,IAAA,MAAMR,IAAA,GAAO,IAAI,CAAC6B,IAAI,CAAC8C,KAAK,CAAClF,KAAK,CAACe,CAAA,CAAE,IAAI,CAAA;AACzC,IAAA,OAAO0F,QAAA,CACL,CAAA,gHAAA,EAAmHb,oBAAoBrF,IAAA,yBAA6B,CAAA;EAExK,CAAA;EAEA,IAAIqG,WAAAA,GAAuB;AACzB,IAAA,OAAO,IAAI,CAACxE,IAAI,CAAClB,KAAK,KAAK2F,SAAA;AAC7B,EAAA;EAEAC,OAAA,GAAWpB,KAAa,IAAe;IACrC,IAAI,IAAI,CAACkB,WAAW,EAAE;AACpB,MAAA,OAAO,IAAI,CAACxE,IAAI,CAAClB,KAAK,CAAEwE,KAAA,CAAM;AAChC,IAAA;AACA,IAAA,OAAOA;EACT,CAAA;AAEA,EAAA;IAAAQ,oBAAA,CAAAC,kBAAA,CAAA,oUAAA,EAUA;MAAAC,UAAA,EAAA;KAAU,CAAA,EAAV,IAAW,CAAA;AAAD;AACZ;AAmBe,MAAMW,eAAA,SAAmCpG,UAC7B;EAEzB,IACIqG,iBAA6B;AAC/B,IAAA,MAAMC,MAAA,GAAS,IAAI,CAAC7E,IAAI,CAAC6E,MAAM;AAC/B,IAAA,MAAMC,CAAA,GAAI,OAAOD,MAAA,KAAW,QAAA,GAAW,CAAA,EAAGA,MAAA,CAAA,EAAA,CAAU,GAAIA,MAAA,IAAU,MAAM;AACxE,IAAA,OAAOR,SACL,CAAA,6FAAA,EAAgGS,CAAA,GAAI,CAAA;AAExG,EAAA;AAAA,EAAA;IAAAC,CAAA,CAAA,IAAA,CAAAtG,SAAA,EAAA,gBAAA,EAAA,CAPCuG,MAAA,CAAA,CAAA;AAAA;EASD,IAAI3E,SAAAA,GAAoB;AACtB,IAAA,OAAO,IAAI,CAACL,IAAI,CAACK,SAAS,IAAI,IAAI,CAACL,IAAI,CAAClB,KAAK,EAAEmG,MAAA,IAAU,CAAA;AAC3D,EAAA;AAEA,EAAA;IAAAnB,oBAAA,CAAAC,kBAAA,CAAA,g5BAAA,EA4CA;MAAAC,UAAA,EAAA,IAAA;AAAAC,MAAAA,KAAA,EAAAA,OAAA;QAAA3F,WAAA;AAAA6F,QAAAA;AAAA,OAAA;KAAU,CAAA,EAAV,IAAW,CAAA;AAAD;AACZ;;;;"}